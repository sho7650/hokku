# Hokku - MVP優先実用設計 (Phase 3移行時の参考)

## ⚠️ 重要な注意

**このドキュメントはPhase 3（完全なSOLID適用）が必要になった場合の参考資料です。**

**現在の実装方針:**
- **Phase 0**: 50行の単一main.go
- **Phase 1-2**: 必要最小限の改善のみ
- **Phase 3**: 本当に必要になってからこの構造を検討

## MVP段階的構造進化

### Phase 0: 最小構造 (30分で実装)
```
hokku/
└── main.go                     # 全機能をここに（50行程度）
```

### Phase 1: 基本分離 (問題が出たら)
```
hokku/
├── main.go                     # エントリーポイント
├── handlers.go                 # ハンドラ関数  
└── utils.go                    # ヘルパー関数（必要なら）
```

### Phase 2: 必要な抽象化 (300行超えたら)
```
hokku/
├── main.go                     # エントリーポイント
├── webhook.go                  # Webhook処理
├── storage.go                  # ファイル保存
└── validation.go               # バリデーション（必要になったら）
```

### Phase 3: 完全構造 (チーム開発・複雑性が必要になったら)
```
hokku/
├── cmd/
│   └── hokku/
│       └── main.go              # エントリーポイント
├── internal/
│   ├── handler/
│   │   ├── webhook.go           # Webhookハンドラー
│   │   └── health.go            # ヘルスチェック
│   ├── service/
│   │   ├── file_writer.go       # ファイル書き込みサービス
│   │   └── validator.go         # バリデーションサービス
│   └── model/
│       ├── webhook.go           # リクエスト/レスポンスモデル
│       └── error.go             # エラーレスポンスモデル
├── pkg/
│   └── security/
│       ├── path.go              # パスバリデーション
│       └── sanitizer.go         # 入力サニタイズ
└── test/                       # テスト（必要に応じて）
```

## YAGNI原則適用指針

### ❌ Phase 0-2で実装してはいけないもの
- internal/パッケージ構造
- middleware層
- 設定ファイル（YAML）
- 複雑なエラーハンドリング
- 認証システム
- ロギングフレームワーク

### ✅ 段階的実装（必要になってから）
- Phase 0: 直接実装のみ
- Phase 1: 基本的な関数分離
- Phase 2: 必要最小限の抽象化
- Phase 3: 完全なSOLID設計（本当に必要な場合のみ）

## 実装移行タイミング

### Phase 0 → Phase 1移行条件
```
以下のいずれかが発生:
- main.goが100行を超える
- 同じコードの重複が3回以上発生
- エラーハンドリングが分かりにくくなる
```

### Phase 1 → Phase 2移行条件
```
以下のいずれかが発生:
- 合計コードが300行を超える
- テストが書きにくくなる
- 複数人での開発が必要
```

### Phase 2 → Phase 3移行条件
```
以下のいずれかが発生:
- チーム開発が本格化
- 複数のストレージバックエンドが必要
- 複雑な認証システムが必要
- マイクロサービス化が必要
```

## まとめ

**核心原則**: 「将来必要になるかも」は実装しない理由。「今必要」だけが実装する理由。

このドキュメントはPhase 3が本当に必要になったときの参考であり、Phase 0-2では `IMPLEMENTATION_APPROACH.md` に従ってください。